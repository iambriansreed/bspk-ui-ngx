import{Pa as p,U as l,bc as r,ca as f,ha as d,ka as h,na as m}from"./chunk-YXGO2XRJ.js";function u(o){o&&"focus"in o&&typeof o.focus=="function"&&o.focus()}var v=class o{enabled=r(!0,{alias:"ui-focus-trap"});autoFocus=r(!0);restoreFocus=r(!0);container=l(m);document=l(f);bound=d(!1);prevFocused=d(null);ngOnChanges(){let e=this.enabled();e&&!this.bound()?(this.attach(),this.autoFocus()&&queueMicrotask(()=>this.focusInitial())):!e&&this.bound()&&(this.detach(),this.restorePreviousFocus())}ngOnDestroy(){this.detach(),this.restorePreviousFocus()}attach(){this.prevFocused.set(this.document?.activeElement),this.document?.addEventListener("keydown",this.onKeyDown,!0),this.document?.addEventListener("focusin",this.onFocusIn,!0),this.bound.set(!0)}detach(){this.document?.removeEventListener("keydown",this.onKeyDown,!0),this.document?.removeEventListener("focusin",this.onFocusIn,!0),this.bound.set(!1)}restorePreviousFocus(){this.restoreFocus()&&(u(this.prevFocused()),this.prevFocused.set(null))}onKeyDown=e=>{if(!(e instanceof KeyboardEvent)||!this.enabled())return;let n=this.container.nativeElement;if(n&&e.key==="Tab"){let t=this.getFocusableElements();if(t.length===0){e.preventDefault(),n.focus();return}let s=this.document?.activeElement,i=t.findIndex(c=>c===s);i===-1&&(i=e.shiftKey?t.length-1:0);let a=e.shiftKey?(i-1+t.length)%t.length:(i+1)%t.length;e.preventDefault(),u(t[a])}};onFocusIn=e=>{if(!this.enabled())return;let n=e.target,t=this.container.nativeElement;if(!(!t||!n)&&!t.contains(n)){let s=this.getFocusableElements();u(s[0]||t)}};focusInitial(){let e=this.container.nativeElement,n=this.getFocusableElements();u(n[0]||e)}getFocusableElements(){let e=this.container.nativeElement;if(!e)return[];let n=["a[href]","button:not([disabled])","input:not([disabled])","textarea:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(",");return Array.from(e.querySelectorAll(n)).filter(s=>this.isFocusable(s))}isFocusable(e){let n=window.getComputedStyle(e),t=e.getBoundingClientRect(),s=n.visibility!=="hidden"&&n.display!=="none",i=!!e.ownerDocument&&!!e.ownerDocument.documentElement.contains(e),a=!e.disabled,c=t.width>0&&t.height>0;return s&&i&&a&&c}static \u0275fac=function(n){return new(n||o)};static \u0275dir=p({type:o,selectors:[["","ui-focus-trap",""]],inputs:{enabled:[1,"ui-focus-trap","enabled"],autoFocus:[1,"autoFocus"],restoreFocus:[1,"restoreFocus"]},features:[h]})};export{v as a};
